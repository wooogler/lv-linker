(this["webpackJsonpabc-analyzer"]=this["webpackJsonpabc-analyzer"]||[]).push([[0],{133:function(e,t){},135:function(e,t){},166:function(e,t,n){},167:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(28),o=n.n(a),i=n(15),u=n(56),l=n(71),s=n(65),d=n.n(s),f=n(86),j=n.n(f),b=n(66),v=n.n(b),m=n(52),h=n(87),O=n(57),p=n(41),x=n.n(p),g=n(88);function w(e){var t={};for(var n in e)if(e.hasOwnProperty(n))if("object"==typeof e[n]&&null!==e[n]){var c=w(e[n]);for(var r in c)c.hasOwnProperty(r)&&(t[n+"_"+r]=c[r])}else t[n]=e[n];return t}var y=function(e){return e.map((function(e,t){var n,c=e[0],r=e[1],a=e[5],o=null===(n=e[8])||void 0===n?void 0:n.replaceAll('""','"').replaceAll(': ", ',': "", ');try{return Object(O.a)({timestamp:a,_id:c,datumType:r},w(JSON.parse(o)))}catch(i){return console.log(i),{timestamp:a,_id:c,datumType:r}}}))};var k,S,C,N=function(e){var t=Object(c.useState)([]),n=Object(i.a)(t,2),r=n[0],a=n[1],o=Object(c.useMemo)((function(){return r.reduce((function(e,t){var n=Object.keys(t);return x.a.union(e,n)}),[])}),[r]);return Object(c.useEffect)((function(){function t(){return(t=Object(h.a)(v.a.mark((function t(){return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Object(g.a)("http://localhost:3000/logs/".concat(e),{worker:!0,complete:function(e){var t=e.data,n=y(t),c=n.reduce((function(e,t){var n=Object.keys(t);return x.a.union(e,n)}),[]).reduce((function(e,t){return Object(O.a)(Object(O.a)({},e),{},Object(m.a)({},t,"empty"))}),{}),r=n.map((function(e){return Object.assign({},c,e)}));a(r)},download:!0});case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[e]),{logData:r,logColumns:o}},T=n(58),I=n(170),R=n(172),E=n(8);d.a.extend(j.a);var _=T.a.div(k||(k=Object(u.a)(["\n  width: 100%;\n  height: 60%;\n  margin: 1rem;\n  .cell {\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    :hover {\n      overflow: visible;\n      white-space: normal;\n    }\n  }\n"]))),B=T.a.div(S||(S=Object(u.a)(["\n  ","\n  ","\n"])),(function(e){return e.passed&&"\n    background: yellow;\n  "}),(function(e){return e.selected&&"\n    background: red;\n  "})),L=T.a.div(C||(C=Object(u.a)([""]))),P=function(e){var t=e.fileName,n=e.sec,r=e.sync,a=e.start,o=(e.setSync,e.setSelectedTimestamp),u=(e.selectedTimestamp,e.playerRef),s=N(t),f=s.logData,j=s.logColumns,b=Object(c.useState)(),v=Object(i.a)(b,2),m=v[0],h=v[1],O=Object(c.useState)([]),p=Object(i.a)(O,2),g=p[0],w=p[1],y=Object(c.useState)([]),k=Object(i.a)(y,2),S=k[0],C=k[1];Object(c.useEffect)((function(){var e=new Array(j.length).fill(!0);console.log(e),w(e),C(new Array(f.length).fill(!0))}),[f.length,j.length]),Object(c.useEffect)((function(){var e=j.filter((function(e,t){return g[t]}));h(f.map((function(t){return x.a.pick(t,e)})).filter((function(e,t){return S[t]})).sort((function(e,t){return parseInt(e.timestamp)-parseInt(t.timestamp)})))}),[f,j,g,S]);var T=Object(c.useState)(""),P=Object(i.a)(T,2),A=P[0],M=P[1],D=Object(c.useCallback)((function(e){M(null===e||void 0===e?void 0:e._id);var t=parseInt(null===e||void 0===e?void 0:e.timestamp);o(t),u.current.seekTo((a+t-r)/1e3,"seconds")}),[u,o,a,r]),F=Object(c.useState)(""),z=Object(i.a)(F,2),J=z[0],W=z[1],G=Object(c.useState)([]),H=Object(i.a)(G,2),q=H[0],K=H[1];Object(c.useEffect)((function(){var e,t,n=j.map((function(e){return{col:e,count:Object.entries(x.a.countBy(null===f||void 0===f?void 0:f.map((function(t){return t[e]}))))}})),c=null===(e=j.map((function(e){return{col:e,count:Object.entries(x.a.countBy(null===m||void 0===m?void 0:m.map((function(t){return t[e]}))))}})).find((function(e){return e.col===J})))||void 0===e?void 0:e.count,r=null===(t=n.find((function(e){return e.col===J})))||void 0===t?void 0:t.count;K(null===r||void 0===r?void 0:r.map((function(e){if(null===c||void 0===c?void 0:c.map((function(e){return e[0]})).includes(e[0])){var t=c.find((function(t){return t[0]===e[0]}));if(void 0===t)throw new Error("no lookup");var n=t[1];return n===e[1]?{value:e[0],count:n,checked:!0,total:e[1]}:{value:e[0],count:n,checked:!1,total:e[1]}}return{value:e[0],count:0,checked:!1,total:e[1]}})))}),[J,f,m,j]);var Q=Object(c.useCallback)((function(e,t){"timestamp"!==t&&"_id"!==t&&"extra_eventTime"!==t&&W(t)}),[]),U=function(e){var t=e.columnIndex,c=e.key,o=e.rowIndex,i=e.style;if(m){var u=j.filter((function(e,t){return g[t]}))[t],l=m[o];return 0===o?Object(E.jsx)(L,{style:i,className:"cell",children:u},c):Object(E.jsx)(B,{style:i,className:"cell",passed:n+r-a>=parseInt(null===l||void 0===l?void 0:l.timestamp),selected:(null===l||void 0===l?void 0:l._id)===A,onClick:function(){return D(l)},children:0!==t?l&&l[u]&&l[u].toString():l&&d()(parseInt(l[u])).format("MM/DD hh:mm:ss.SSS")},c)}},V=Object(c.useState)(0),X=Object(i.a)(V,2),Y=X[0],Z=X[1];Object(c.useEffect)((function(){var e=m?m.findIndex((function(e){return n+r-a<=parseInt(null===e||void 0===e?void 0:e.timestamp)})):0;Z(e+5)}),[m,n,a,r]);var $=Object(c.useCallback)((function(e,t){C(t?function(t){return t.map((function(t,n){return!0===t?f[n][J]!==e:t}))}:function(t){return t.map((function(t,n){return!1===t?f[n][J]===e:t}))})}),[J,f]),ee=Object(c.useCallback)((function(e){!e.target.checked||e.target.indeterminate?w((function(e){return e.map((function(){return!1}))})):w((function(e){return e.map((function(){return!0}))}))}),[]),te=Object(c.useCallback)((function(e){!e.target.checked||e.target.indeterminate?C((function(e){return e.map((function(){return!1}))})):C((function(e){return e.map((function(){return!0}))}))}),[]),ne=Object(c.useState)([]),ce=Object(i.a)(ne,2),re=ce[0],ae=ce[1],oe=Object(c.useState)([]),ie=Object(i.a)(oe,2),ue=ie[0],le=ie[1];Object(c.useEffect)((function(){ae(q),le(j)}),[q,j]);var se=Object(c.useCallback)((function(e){le(j.filter((function(t){return t.toLowerCase().includes(e.target.value.toLowerCase())})))}),[j]),de=Object(c.useCallback)((function(e){ae(null===q||void 0===q?void 0:q.filter((function(t){return t.value.toLowerCase().includes(e.target.value.toLowerCase())})))}),[q]),fe=g.filter((function(e,t){return 1!==t}));return Object(E.jsxs)("div",{className:"w-full h-screen",children:[Object(E.jsx)(_,{children:Object(E.jsx)(l.a,{children:function(e){var t=e.height,n=e.width;return Object(E.jsx)(l.b,{height:t,rowHeight:30,width:n,fixedColumnCount:1,fixedRowCount:1,cellRenderer:U,style:{border:"1px solid #ddd"},styleTopLeftGrid:{borderBottom:"2px solid #aaa",borderRight:"2px solid #aaa",fontWeight:"bold"},rowCount:S.filter(Boolean).length,columnCount:g.filter(Boolean).length,columnWidth:150,scrollToRow:Y})}})}),Object(E.jsxs)("div",{className:"flex",children:[Object(E.jsxs)("div",{className:"flex flex-col ml-4",children:[Object(E.jsx)("div",{className:"text-lg font-bold",children:"Show Columns"}),Object(E.jsx)(I.a,{size:"small",onChange:se}),Object(E.jsx)(R.a,{checked:fe.every((function(e){return!0===e})),indeterminate:!fe.every((function(e){return!0===e}))&&fe.some((function(e){return!0===e})),onChange:ee,className:"p-1",children:"Select All"}),Object(E.jsx)("div",{className:"h-60 overflow-auto",children:ue.map((function(e,t){return Object(E.jsxs)("div",{className:"flex p-1 ".concat("timestamp"!==e&&"cursor-pointer hover:bg-gray-200"," ").concat(e===J&&"bg-blue-200"),onClick:function(t){return Q(t,e)},children:[Object(E.jsx)(R.a,{onClick:function(e){return function(e,t){e.stopPropagation(),w((function(e){return e.map((function(e,n){return t===n?!e:e}))}))}(e,t)},checked:g[t]},t),Object(E.jsx)("div",{className:"w-36 pl-2",children:e})]})}))})]}),""!==J&&Object(E.jsxs)("div",{className:"flex flex-col ml-4",children:[Object(E.jsxs)("div",{className:"text-lg font-bold",children:["Column Filter - ",J]}),Object(E.jsx)(I.a,{size:"small",onChange:de}),Object(E.jsx)("div",{className:"p-1",children:Object(E.jsx)(R.a,{checked:null===q||void 0===q?void 0:q.map((function(e){return e.checked})).every((function(e){return!0===e})),indeterminate:!(null===q||void 0===q?void 0:q.map((function(e){return e.checked})).every((function(e){return!0===e})))&&(null===q||void 0===q?void 0:q.map((function(e){return e.checked})).some((function(e){return!0===e}))),onChange:te,children:"Select All"})}),Object(E.jsx)("div",{className:"h-60 overflow-auto",children:null===re||void 0===re?void 0:re.sort((function(e,t){return t.total-e.total})).map((function(e){return Object(E.jsx)("div",{className:"p-1",children:Object(E.jsxs)(R.a,{checked:e.checked,indeterminate:0!==e.count&&!e.checked,onClick:function(){return $(e.value,e.checked)},children:[e.value," (",e.count,"/",e.total,")"]},e.value)})}))})]})]})]})},A=(n(147),n(109)),M=n.n(A);var D=function(e){var t=e.url,n=e.setSec,r=e.setSync,a=e.setStart,o=e.selectedTimestamp,u=e.playerRef,l=Object(c.useState)(0),s=Object(i.a)(l,2),d=s[0],f=s[1];return Object(c.useCallback)((function(){r(o),a(d)}),[d,o,a,r]),Object(E.jsx)("div",{className:"h-screen w-full p-4",children:Object(E.jsx)(M.a,{url:t,controls:!0,width:"100%",height:"100%",onProgress:function(e){n(Math.floor(1e3*e.playedSeconds)),f(Math.floor(1e3*e.playedSeconds))},progressInterval:10,ref:u})})};var F=function(){var e=Object(c.useState)(1629813828796),t=Object(i.a)(e,2),n=t[0],r=t[1],a=Object(c.useState)(0),o=Object(i.a)(a,2),u=o[0],l=o[1],s=Object(c.useState)(6835),d=Object(i.a)(s,2),f=d[0],j=d[1],b=Object(c.useState)(0),v=Object(i.a)(b,2),m=v[0],h=v[1],O=Object(c.useRef)();return Object(E.jsxs)("div",{className:"flex h-screen overflow-hidden",children:[Object(E.jsx)("div",{className:"w-2/3 h-screen",children:Object(E.jsx)(P,{fileName:"20.4.csv",sec:u,sync:n,setSelectedTimestamp:h,playerRef:O,setSync:r,selectedTimestamp:m,start:f})}),Object(E.jsx)("div",{className:"w-1/3 h-screen",children:Object(E.jsx)(D,{url:"videos/P020_10.webm",setSec:l,setSync:r,setStart:j,selectedTimestamp:m,playerRef:O})})]})},z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,173)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),c(e),r(e),a(e),o(e)}))};n(166);o.a.render(Object(E.jsx)(r.a.StrictMode,{children:Object(E.jsx)(F,{})}),document.getElementById("root")),z()}},[[167,1,2]]]);
//# sourceMappingURL=main.c1a1e232.chunk.js.map